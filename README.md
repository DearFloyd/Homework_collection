# 使用说明
本仓库为三讲作业合用仓库，包含**第二、三、四讲作业代码以及讨论**。  
工程环境python3.9
## 第二讲作业代码
进入mian process.py运行
执行文件后首先进行视频序列的随机生成，较为耗时，需等待约10秒钟。  
**标准规则**定义：作者类别<=2，项目类别<=3，音乐类别<=1  
## 第四讲作业代码
进入DPP.py运行。  
本讲作业只实现了greedy search算法，未能实现beam search算法  
# 第二讲 窗口打散结果分析
## V1.0.0版本
1.此版本算法中，每次由前往后遍历窗口中的视频特征，出现不满足规则的重复特征时，将后出现的那个重复特征与出窗口。
而此算法在较短序列中，一旦重复出现的特征中的第一个特征所在窗口中的位置较为靠后，会使得本能打散的序列因不符合规则而打散失败。  
2.因此要考虑将重复出现的特征中的第一个特征向前移动，尽可能使得两个或者多个特征之间距离足够远。  
例如下图中的序列，可以看到，将第一个music_id93前移即可完成打散，但因两者出现的距离过近没有后续移动空间导致失败。  
![image](https://user-images.githubusercontent.com/55337511/170055980-5ebd27dc-8e88-4b2b-92c4-b22a8b6bc934.png)
### 打散失败率
V1.0.0版本算法在**标准规则、20长度序列、8长度窗口**的要求下，10000次打散失败率经多次测试均约为25%，其中不符合背景音乐规则的失败率约占到99%以上，耗时约2.4秒。  
·以下取一次结果展示：  
![image](https://user-images.githubusercontent.com/55337511/170638622-bba0a23c-bfdd-40fc-9a1a-b3730173daea.png)
## V2.0.0版本
1.此版本算法中，考虑V1版本缺陷，当第一次正序打散失败时进行二次打散，第二次打散采用倒序的方式，从序列末尾开始进行窗口滚动。  
2.观察到打散失败的绝大部分由于在20长度的序列中出现了4个及以上的相同背景音乐特征，当窗口为8时，4个及以上的背景音乐特征c必定无法打散。
### 打散失败率
在**标准规则、20长度序列、8长度窗口**的要求下，10000次打散失败率经多次测试均约为0.4%，其中不符合背景音乐规则的失败率约占到99%以上，耗时约3秒。  
·以下取一次结果展示：  
![image](https://user-images.githubusercontent.com/55337511/170635921-827432c7-c26a-4a06-bd36-35e8c9b5edaf.png)  
在**标准规则、20长度序列、4长度窗口**的要求下，10000次打散失败率经多次测试均约为0%，耗时约1.7秒。  
·以下取一次结果展示：  
![image](https://user-images.githubusercontent.com/55337511/171424857-5b920d8f-28d8-495e-a263-d5a974686cc0.png)  
在**标准规则、40长度序列、8长度窗口**的要求下，10000次打散失败率经多次测试均约为0.04%，其中不符合背景音乐规则的失败率约占到99%以上，耗时约7.8秒。  
·以下取一次结果展示：  
![image](https://user-images.githubusercontent.com/55337511/171426854-c7f3fd93-7668-4cfa-af63-cde5341a8713.png)  
在**标准规则、40长度序列、16长度窗口**的要求下，10000次打散失败率经多次测试均约为6.8%，其中不符合背景音乐规则的失败率约占到99%以上，耗时约18秒。  
·以下取一次结果展示：  
![image](https://user-images.githubusercontent.com/55337511/171427524-72f3892b-c434-4aec-839a-67bf48aeda8d.png)  
### 总结
由对比实验可见，本算法在较短序列中的运行速度较快，性能较好。当序列增长时，算法耗时提高较大，性能下降。此外，窗口长度对性能影响也较大，当序列长度相较窗口长度差距越大，打散失败率越低。
### 打散对推荐效果的思考
考虑打散前后的用户点击率以及完波率对比，对一个召回序列，记录哪些是打散后出现的，哪些是打散前存在的。跟踪用户的行为，来确定用户对打散后出现的这些新视频的兴趣程度，同时也要考虑这些新视频的特征与用户早先观看的视频特征的差异，差异越大，则表明打散后对推荐效果的提升越大。另外，用户在打散过的召回序列与未经打散的召回序列之间总点击率、完播率的差异也可列为一项推荐效果的评估指标，点击率、完播率越高，推荐效果越好。
# 第三讲 待思考问题讨论
针对第三小问每个视频均包含相同的path是否合理：  
认为应该针对视频类别的稀有度，来相应的增大或者减小path个数，这里的稀有度指的是这个视频的类别在类别。根据视频所属门类，给定视频一个权重，使小门类、小受众的视频，也能被检索到，不至于被热门视频淹没，导致用户，让视频分布更符合实际。
